<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimador de Costos Bedrock – Farmacity</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f3f4f6; color: #1f2937; padding: 16px; }
  .container { max-width: 680px; margin: 0 auto; }
  h1 { font-size: 20px; font-weight: 700; }
  .subtitle { font-size: 13px; color: #6b7280; margin-bottom: 16px; }
  .card { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 12px; }
  .results-card { background: linear-gradient(135deg, #eff6ff, #eef2ff); border: 1px solid #bfdbfe; border-radius: 12px; padding: 20px; }
  .section-title { font-size: 11px; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px; margin-bottom: 12px; margin-top: 16px; }
  .section-title:first-child { margin-top: 0; }
  .row { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; }
  .row label { font-size: 13px; color: #374151; flex: 1; }
  .row .hint { display: block; font-size: 11px; color: #9ca3af; }
  .row input { width: 100px; padding: 5px 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 13px; text-align: right; outline: none; }
  .row input:focus { border-color: #93c5fd; box-shadow: 0 0 0 2px rgba(147,197,253,0.3); }
  .row .unit { font-size: 11px; color: #9ca3af; width: 55px; text-align: left; margin-left: 6px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 16px; }
  .stat-box { background: #fff; border-radius: 8px; padding: 10px; text-align: center; }
  .stat-box .label { font-size: 11px; color: #6b7280; }
  .stat-box .value { font-size: 17px; font-weight: 700; color: #111827; }
  .cost-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 13px; }
  .cost-row .val { font-weight: 600; }
  .total-row { display: flex; justify-content: space-between; background: #dbeafe; padding: 10px 14px; border-radius: 8px; margin-bottom: 4px; }
  .total-row span { font-size: 15px; font-weight: 700; color: #1e40af; }
  .notes { background: #fff; border-radius: 8px; padding: 12px; margin-top: 14px; font-size: 11px; color: #4b5563; line-height: 1.7; }
  .notes strong { color: #1f2937; }
  .notes-title { font-size: 11px; font-weight: 600; color: #6b7280; margin-bottom: 6px; }
  table.prices { width: 100%; font-size: 12px; border-collapse: collapse; }
  table.prices th { text-align: left; color: #6b7280; padding-bottom: 4px; font-weight: 500; }
  table.prices th:not(:first-child) { text-align: right; }
  table.prices td { padding: 4px 0; border-top: 1px solid #f3f4f6; }
  table.prices td:not(:first-child) { text-align: right; }
  table.prices td:first-child { font-weight: 500; }
  .source { font-size: 10px; color: #9ca3af; margin-top: 8px; }
  .sep { border-top: 2px solid #93c5fd; margin-top: 10px; padding-top: 10px; }
  .sep2 { border-top: 1px solid #d1d5db; margin-top: 10px; padding-top: 10px; }
  .logo-bar { display: flex; align-items: center; gap: 10px; margin-bottom: 4px; }
  .badge { display: inline-block; background: #dbeafe; color: #1e40af; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 99px; }
  @media (max-width: 500px) {
    .grid { grid-template-columns: 1fr; }
    .row { flex-wrap: wrap; gap: 4px; }
    .row input { width: 80px; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="logo-bar">
    <h1>Estimador de Costos Bedrock</h1>
    <span class="badge">MVP</span>
  </div>
  <p class="subtitle">Farmacity – Chatbot Soporte 24/7 – Claude Haiku 4.5 &nbsp;|&nbsp; DinoCloud &nbsp;|&nbsp; Feb 2026</p>

  <div class="card">
    <div class="section-title">Volumen de Conversaciones (24/7)</div>
    <div class="row"><label>Conversaciones por día <span class="hint">Promedio incluyendo noches y fines de semana</span></label><input id="convDay" type="number" value="100"><span class="unit">conv/día</span></div>
    <div class="row"><label>Turnos por conversación <span class="hint">Ida y vuelta usuario ↔ bot</span></label><input id="turns" type="number" value="5"><span class="unit">turnos</span></div>
    <div class="row"><label>Días operativos por mes <span class="hint">24/7 = 30 días</span></label><input id="days" type="number" value="30"><span class="unit">días</span></div>

    <div class="section-title">Tokens por Turno (Chatbot)</div>
    <div class="row"><label>System prompt</label><input id="sysTk" type="number" value="800"><span class="unit">tokens</span></div>
    <div class="row"><label>Contexto KB (InvGate) <span class="hint">Artículos recuperados</span></label><input id="kbTk" type="number" value="1500"><span class="unit">tokens</span></div>
    <div class="row"><label>Query del usuario</label><input id="queryTk" type="number" value="80"><span class="unit">tokens</span></div>
    <div class="row"><label>Crecimiento historial/turno <span class="hint">Contexto acumulado</span></label><input id="histTk" type="number" value="300"><span class="unit">tokens</span></div>
    <div class="row"><label>Respuesta del chatbot (output)</label><input id="respTk" type="number" value="250"><span class="unit">tokens</span></div>

    <div class="section-title">Imágenes (% de requests)</div>
    <div class="row"><label>% requests con imagen <span class="hint">Imagen solo en primer turno de la conversación</span></label><input id="imgPct" type="number" value="30"><span class="unit">%</span></div>
    <div class="row"><label>Imágenes por request</label><input id="imgCount" type="number" value="1"><span class="unit">imgs</span></div>
    <div class="row"><label>Resolución promedio <span class="hint">tokens = (L × W) / 750</span></label><input id="imgL" type="number" value="1280" style="width:70px"><span style="font-size:13px;color:#6b7280;margin:0 2px">×</span><input id="imgW" type="number" value="720" style="width:70px"><span class="unit">px</span></div>
  </div>

  <div class="card">
    <div class="section-title" style="margin-top:0">Precios On-Demand – Claude Haiku 4.5 (US East, Feb 2026)</div>
    <table class="prices">
      <thead><tr><th>Tipo</th><th>Precio / 1M tokens</th></tr></thead>
      <tbody>
        <tr><td>Input tokens (texto)</td><td>$1.00</td></tr>
        <tr><td>Input tokens (imágenes)</td><td>$1.00</td></tr>
        <tr><td>Output tokens</td><td>$5.00</td></tr>
      </tbody>
    </table>
    <p class="source">Fuente: aws.amazon.com/bedrock/pricing — consultado Feb 2026</p>
  </div>

  <div class="results-card">
    <div class="section-title" style="margin-top:0">Resultados</div>
    <div class="grid">
      <div class="stat-box"><div class="label">Conv/mes</div><div class="value" id="rConvMonth">—</div></div>
      <div class="stat-box"><div class="label">Turnos/mes</div><div class="value" id="rTurns">—</div></div>
      <div class="stat-box"><div class="label">Input tokens/mes</div><div class="value" id="rInput">—</div></div>
      <div class="stat-box"><div class="label">Output tokens/mes</div><div class="value" id="rOutput">—</div></div>
    </div>
    <div class="cost-row"><span>Texto (input + output)</span><span class="val" id="rChatText">—</span></div>
    <div class="cost-row"><span>Imágenes (input)</span><span class="val" id="rChatImg">—</span></div>
    <div class="sep">
      <div class="total-row"><span>Total Mensual</span><span id="rMonthly">—</span></div>
      <div class="total-row"><span>Total Anual</span><span id="rAnnual">—</span></div>
    </div>
    <div class="sep2">
      <div class="cost-row"><span>Costo por conversación</span><span class="val" id="rPerConv">—</span></div>
      <div class="cost-row"><span>Tokens imagen por foto <span style="font-size:11px;color:#9ca3af;">((L×W)/750)</span></span><span class="val" id="rImgTk">—</span></div>
    </div>

    <div style="background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;padding:14px;margin-top:14px;">
      <div style="font-size:11px;font-weight:600;color:#9ca3af;margin-bottom:8px;">DETALLE DEL CÁLCULO</div>
      <div id="calcDetail" style="font-size:11px;color:#6b7280;line-height:1.8;font-family:monospace;"></div>
    </div>


  </div>

  <p style="text-align:center;font-size:10px;color:#9ca3af;margin-top:16px;">DinoCloud × AWS Partner Network — Febrero 2026</p>
</div>

<script>
const $ = id => document.getElementById(id);
const fmt = n => '$' + n.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
const fmtN = n => n.toLocaleString('en-US');

function calc() {
  const convDay = +$('convDay').value || 0;
  const turns = +$('turns').value || 0;
  const days = +$('days').value || 0;
  const sysTk = +$('sysTk').value || 0;
  const kbTk = +$('kbTk').value || 0;
  const queryTk = +$('queryTk').value || 0;
  const histTk = +$('histTk').value || 0;
  const respTk = +$('respTk').value || 0;
  const imgPct = +$('imgPct').value || 0;
  const imgCount = +$('imgCount').value || 0;
  const imgL = +$('imgL').value || 0;
  const imgW = +$('imgW').value || 0;

  const convMonth = convDay * days;
  const totalTurns = convMonth * turns;

  let textInputPerConv = 0;
  for (let t = 0; t < turns; t++) {
    textInputPerConv += sysTk + kbTk + queryTk + t * histTk;
  }
  const textInputTotal = textInputPerConv * convMonth;
  const textOutputTotal = totalTurns * respTk;

  const imgTokensPerImg = Math.round((imgL * imgW) / 750);
  const imgConvsMonth = Math.round(convMonth * imgPct / 100);
  const imgTokensTotal = imgConvsMonth * imgCount * imgTokensPerImg;

  const inPrice = 1.0;
  const outPrice = 5.0;
  const textCost = (textInputTotal / 1e6) * inPrice + (textOutputTotal / 1e6) * outPrice;
  const imgCost = (imgTokensTotal / 1e6) * inPrice;

  const monthly = textCost + imgCost;
  const annual = monthly * 12;
  const perConv = convMonth > 0 ? monthly / convMonth : 0;

  $('rConvMonth').textContent = fmtN(convMonth);
  $('rTurns').textContent = fmtN(totalTurns);
  $('rInput').textContent = ((textInputTotal + imgTokensTotal) / 1e6).toFixed(1) + 'M';
  $('rOutput').textContent = (textOutputTotal / 1e6).toFixed(1) + 'M';
  $('rChatText').textContent = fmt(textCost);
  $('rChatImg').textContent = fmt(imgCost);
  $('rMonthly').textContent = fmt(monthly);
  $('rAnnual').textContent = fmt(annual);
  $('rPerConv').textContent = fmt(perConv);
  $('rImgTk').textContent = fmtN(imgTokensPerImg) + ' tk';

  // Build calculation detail
  const lines = [];
  lines.push('<strong>─ Volumen</strong>');
  lines.push(`${fmtN(convDay)} conv/día × ${days} días = <strong>${fmtN(convMonth)} conv/mes</strong>`);
  lines.push(`${fmtN(convMonth)} conv × ${turns} turnos = <strong>${fmtN(totalTurns)} turnos/mes</strong>`);
  lines.push('');
  lines.push('<strong>─ Input tokens texto (por conversación)</strong>');
  let runningTotal = 0;
  for (let t = 0; t < turns; t++) {
    const h = t * histTk;
    const tot = sysTk + kbTk + queryTk + h;
    runningTotal += tot;
    lines.push(`Turno ${t+1}: ${fmtN(sysTk)} sys + ${fmtN(kbTk)} kb + ${fmtN(queryTk)} query + ${fmtN(h)} hist = ${fmtN(tot)} tk`);
  }
  lines.push(`Total por conv: <strong>${fmtN(runningTotal)} tk</strong>`);
  lines.push(`Mensual: ${fmtN(runningTotal)} × ${fmtN(convMonth)} = <strong>${(textInputTotal/1e6).toFixed(2)}M tk</strong>`);
  lines.push('');
  lines.push('<strong>─ Output tokens</strong>');
  lines.push(`${fmtN(respTk)} tk/turno × ${fmtN(totalTurns)} turnos = <strong>${(textOutputTotal/1e6).toFixed(2)}M tk</strong>`);
  lines.push('');
  lines.push('<strong>─ Imágenes (solo primer turno)</strong>');
  lines.push(`Tokens/img: (${fmtN(imgL)} × ${fmtN(imgW)}) / 750 = <strong>${fmtN(imgTokensPerImg)} tk</strong>`);
  lines.push(`Conv con imagen: ${fmtN(convMonth)} × ${imgPct}% = ${fmtN(imgConvsMonth)} conv`);
  lines.push(`${fmtN(imgConvsMonth)} conv × ${imgCount} img × ${fmtN(imgTokensPerImg)} tk = <strong>${(imgTokensTotal/1e6).toFixed(2)}M tk</strong>`);
  lines.push('');
  lines.push('<strong>─ Costos (Claude Haiku 4.5 @ $1.00/1M in, $5.00/1M out)</strong>');
  lines.push(`Texto input:  ${(textInputTotal/1e6).toFixed(2)}M × $1.00 = ${fmt((textInputTotal/1e6)*inPrice)}`);
  lines.push(`Texto output: ${(textOutputTotal/1e6).toFixed(2)}M × $5.00 = ${fmt((textOutputTotal/1e6)*outPrice)}`);
  lines.push(`Imágenes:     ${(imgTokensTotal/1e6).toFixed(2)}M × $1.00 = ${fmt((imgTokensTotal/1e6)*inPrice)}`);
  lines.push(`<strong>Total mensual: ${fmt(monthly)}</strong>`);
  lines.push(`<strong>Total anual:   ${fmt(annual)}</strong>`);

  $('calcDetail').innerHTML = lines.join('<br>');
}

document.querySelectorAll('input').forEach(el => el.addEventListener('input', calc));
calc();
</script>
</body>
</html>